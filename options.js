(()=>{"use strict";(()=>{function e(e,t){return new Promise((n=>{const i={};i[e]=t,chrome.storage.sync.set(i,(()=>{chrome.runtime.lastError?(console.log(chrome.runtime.lastError.message),chrome.storage.local.set(i,(()=>n()))):(chrome.storage.local.remove(e),n())}))}))}function t(e){return new Promise((t=>{chrome.storage.sync.get(e,(n=>{chrome.storage.local.get(e,(e=>{const i={...n,...e};t(i)}))}))}))}const n="autopilotActions";let i=[];function o(){const e={number:i.length+1,id:([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)))};return i.push(e),e}async function a(){const e=await async function(){return(await t([n]))[n]}();return Array.isArray(e)&&(i=e),i}async function l(){await e(n,i)}const s={},r={},c={},u=(e,t)=>{const n=document.createElement("img");return n.classList.add("icon"),n.setAttribute("alt",t),n.setAttribute("src",e),n.setAttribute("title",t),n.style.display="none",n},d={addAlias:(e,t)=>{s[e]=t},hide:e=>{s[e]&&(e=s[e]),r[e].style.display="none",c[e].style.display="none"},animateProcess:e=>{s[e]&&(e=s[e]),r[e].style.display="none",c[e].style.display="initial"},animateSuccess:e=>{s[e]&&(e=s[e]),c[e].style.display="none",r[e].style.display="initial"},create:e=>{if(s[e])return;const t=document.querySelector(`label[for="${e}"]`);t.textContent=`${t.textContent} `,r[e]=u("check.svg","Successfully updated"),t.appendChild(r[e]),c[e]=u("spinner.svg","Updating..."),c[e].classList.add("icon--spin"),t.appendChild(c[e])}};function w(e){let t;return()=>{clearTimeout(t),t=setTimeout(e,200)}}const p=({id:e})=>`action_${e}_url`;const m=e=>{const t=document.getElementById(p(e));["mass_follow","mass_like","mass_retweet"].includes(e.type)?t.style.display="initial":t.style.display="none"};const f=({id:e})=>`action_${e}_type`;const k=e=>`${f(e)}_label`;const y=({id:e})=>`action_${e}_idle_timeout`;const v=({id:e})=>`action_${e}_limit`;const M=({id:e})=>`action_${e}_remove`;function g(e){const t=document.getElementById(M(e));t.addEventListener("click",(async()=>{d.animateProcess(f(e)),t.disabled=!0,function({id:e}){i.forEach(((t,n)=>{t.id===e&&i.splice(n,1)})),i.forEach(((e,t)=>{e.number=t+1}))}(e),await l(),t.closest(".action").remove(),i.forEach((e=>function(e){document.getElementById(k(e)).textContent=`#${e.number}`}(e)))}))}const h=document.getElementById("actions");function A(e){const t=document.createElement("tr");t.classList.add("action"),t.innerHTML=`\n    <td>${function(e){return`<label id="${k(e)}" for="${f(e)}">#${e.number}</label>`}(e)}</td>\n    <td>${function(e){return`\n    <select id="${f(e)}" required>\n      <option value="" disabled selected>Select action</option>\n      <option value="mass_follow">Mass follow</option>\n      <option value="mass_unfollow">Mass unfollow</option>\n      <option value="mass_like">Mass like</option>\n      <option value="mass_unlike">Mass unlike</option>\n      <option value="mass_retweet">Mass retweet</option>\n      <option value="mass_unretweet">Mass unretweet</option>\n    </select>\n  `}(e)}</td>\n    <td>${function(e){return`<input class="action__url-field" type="text" id="${p(e)}" placeholder="URL">`}(e)}</td>\n    <td>${function(e){return`<input type="number" step="1" id="${v(e)}" placeholder="Limit">`}(e)}</td>\n    <td>${function(e){return`<input type="number" step="0.1" id="${y(e)}" placeholder="Idle timeout">`}(e)}</td>\n    <td>${function(e){return`<button id="${M(e)}" class="button button--remove">Remove</a>`}(e)}</td>\n  `,h.append(t),function(e){d.create(f(e))}(e),function(e){const t=document.getElementById(f(e));e.type&&(t.value=e.type),t.addEventListener("change",(()=>{e.type=t.value,d.animateProcess(f(e)),m(e)})),t.addEventListener("change",w((async()=>{await l(),d.animateSuccess(f(e))})))}(e),function(e){const t=document.getElementById(p(e));e.url&&(t.value=e.url),d.addAlias(p(e),f(e)),t.addEventListener("input",(()=>{e.url=t.value,d.animateProcess(p(e))})),t.addEventListener("input",w((async()=>{await l(),d.animateSuccess(p(e))}))),m(e)}(e),function(e){const t=document.getElementById(v(e));e.limit&&(t.value=e.limit),d.addAlias(v(e),f(e)),t.addEventListener("input",(()=>{e.limit=t.value,d.animateProcess(v(e))})),t.addEventListener("input",w((async()=>{await l(),d.animateSuccess(v(e))})))}(e),function(e){const t=document.getElementById(y(e));e.idleTimeout&&(t.value=e.idleTimeout),d.addAlias(y(e),f(e)),t.addEventListener("input",(()=>{e.idleTimeout=t.value,d.animateProcess(y(e))})),t.addEventListener("input",w((async()=>{await l(),d.animateSuccess(y(e))})))}(e),g(e)}async function S(){const e=await a();for(let t=e.length;t<3;t++)o();e.forEach((e=>A(e))),function(e){e.addEventListener("click",(()=>{A(o())}))}(document.getElementById("add_action"))}const H=()=>{document.body.classList.add("is-pro");const e=document.getElementById("proActivationKey");if(e){e.value="All features unlocked";e.readOnly=!0;const t=e.nextElementSibling;t&&(t.textContent="All automation features are available without an activation key.",t.style.color="#28a745");}};async function $(e){const n=Object.keys(e),i=await t(n);return{...e,...i}}const T={followBlacklist:"@username1,@username2",followBioBlacklist:"",followBioRequired:!1,followBioWhitelist:"",followDailyLimit:"",followIntervalMax:8,followIntervalMin:4,followLimit:400,followMaxFollowers:"",followMaxFollowersFollowingRatio:"",followMaxFollowing:"",followMinFollowers:"",followMinFollowing:"",followMinFollowersFollowingRatio:"",followPauseAfterSkipMax:"",followPauseAfterSkipMin:"",followPauseWhenTwitterLimitExceeded:5,followProfileImageRequired:!1,followProtectedRequired:!1,followSkipFollowed:!0,followSkipFollower:!1,followSkipProtected:!1,followSkipVerified:!1,followTweetLanguageWhitelist:""},B=()=>$(T),C={likeMaxFollowers:"",likeMaxFollowersFollowingRatio:"",likeMaxFollowing:"",likeMaxTweetLikes:"",likeMinFollowers:"",likeMinFollowing:"",likeMinFollowersFollowingRatio:"",likeMinTweetLikes:"",likeIntervalMax:8,likeIntervalMin:4,likeLanguageWhitelist:"",likeLimit:1e3,likePauseWhenUnableToLike:10,likeSkipFollowed:!1,likeSkipReplies:!1,likeSkipRetweets:!1,likeSkipRetweetsWithComment:!1,likeSkipLikedXTweetsFromUser:"",likeTweetTextBlacklist:""},W=()=>$(C),q={retweetIntervalMax:8,retweetIntervalMin:4,retweetLanguageWhitelist:"",retweetLimit:1e3,retweetPauseWhenUnableToRetweet:10,retweetSkipFollowed:!1,retweetSkipReplies:!1,retweetSkipRetweets:!1,retweetSkipRetweetsWithComment:!1,retweetTweetTextBlacklist:""},j=()=>$(q),D={unfollowBlacklist:"@username1,@username2",unfollowBioBlacklist:"",unfollowFollowersLessThan:"",unfollowFollowersGreaterThan:"",unfollowFollowingLessThan:"",unfollowFollowingGreaterThan:"",unfollowIntervalMax:8,unfollowIntervalMin:4,unfollowLimit:"",unfollowMassFollowedRequired:!1,unfollowMinDaysFollowed:2,unfollowPauseAfterSkipMax:"",unfollowPauseAfterSkipMin:"",unfollowSkipFollower:!0,unfollowSkipVerified:!1},K=()=>$(D),U={unretweetIntervalMax:8,unretweetIntervalMin:4,unretweetLimit:"",unretweetMassRetweetedRequired:!1,unretweetMinDaysSinceRetweet:2};const O={unlikeIntervalMax:8,unlikeIntervalMin:4,unlikeLimit:"",unlikeMassLikedRequired:!1,unlikeMinDaysSinceLike:2};const V={autopilotPauseAfterActionMax:"",autopilotPauseAfterActionMin:"",autopilotRepeatAfter:60,autopilotRepeatAfterMax:60};d.addAlias("followIntervalMax","followIntervalMin"),d.addAlias("unfollowIntervalMax","unfollowIntervalMin"),d.addAlias("likeIntervalMax","likeIntervalMin"),d.addAlias("retweetIntervalMax","retweetIntervalMin"),d.addAlias("unretweetIntervalMax","unretweetIntervalMin"),d.addAlias("unlikeIntervalMax","unlikeIntervalMin"),d.addAlias("autopilotPauseAfterActionMax","autopilotPauseAfterActionMin"),d.addAlias("likeSkipRetweetsWithComment","likeSkipRetweets"),d.addAlias("likeSkipReplies","likeSkipRetweets"),d.addAlias("autopilotRepeatAfterMax","autopilotRepeatAfter"),d.addAlias("retweetSkipRetweetsWithComment","retweetSkipRetweets"),d.addAlias("retweetSkipReplies","retweetSkipRetweets"),d.addAlias("unfollowPauseAfterSkipMax","unfollowPauseAfterSkipMin"),d.addAlias("followPauseAfterSkipMax","followPauseAfterSkipMin");const G=async(t,n)=>{await e(t,n),d.animateSuccess(t)};(async()=>{H();let e=await B();e={...e,...await W()},e={...e,...await j()},e={...e,...await K()},e={...e,...await $(O)},e={...e,...await $(U)},e={...e,...await $(V)},Object.keys(e).forEach((t=>{const n=document.getElementById(t);d.create(t),"checkbox"===n.type?(n.checked=e[t],n.addEventListener("change",(()=>d.animateProcess(t))),n.addEventListener("change",w((()=>G(t,n.checked))))):(n.value=e[t],n.addEventListener("input",(()=>d.animateProcess(t))),n.addEventListener("input",w((()=>G(t,n.value)))))})),await S()})()})()})();